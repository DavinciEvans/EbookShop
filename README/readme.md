# 电子书网上书店接口清单

## 约定

- 所有接口，均已 `/api/v1` 开头。`/:id` 代表在此处加上一 `id` 值，例如 `/api/v1/book/2` 代表 id = 2 的书籍。

- 如果需要进行登录后才可访问的，会在开头指明。
- 所有返回值当中，均包含 `status` 项。如果报错会包含 `msg` 项。若正确并返回数据则会包含 `data` 项，没有返回数据需要返回则会包含 `msg` 项。之后不会多加赘述这类信息。

`status` 项的含义如下表：

| status 码 | 含义                         |
| --------- | ---------------------------- |
| 200       | 请求处理成功                 |
| 400       | 请求处理失败，请检查请求配置 |
| 401       | 未授权                       |
| 404       | 该路由不存在                 |

## /book

### GET /

批量获得书籍信息，但不包含书籍的内容，每页默认显示 8 条信息。

#### 参数

| 参数名   | 解释                                                         | 示例       |
| -------- | ------------------------------------------------------------ | ---------- |
| page     | 需要请求的页面，为空默认为第一页                             | page=2     |
| category | 需要请求的书籍分类，传入分类id                               | category=3 |
| hot      | 返回数据按照评分排序，为 1 降序，为 -1 升序。默认按照 id 顺序排列 | hot=1      |

#### 返回

| 返回字段名      | 含义                                                         |
| --------------- | ------------------------------------------------------------ |
| data            | 数据信息                                                     |
| all books count | 数据库当中所有条目的总数，方便制作分页。如果加入了 category 参数，则表示该分类下所有条目总数 |

data 数据格式及含义：

| 字段名称  | 说明         |
| --------- | ------------ |
| ID        | 书籍ID       |
| Name      | 书籍名称     |
| Price     | 书籍价格     |
| Author    | 书籍作者     |
| Star      | 书籍评分     |
| PayNumber | 书籍购买人数 |
| Category  | 所属分类     |

### GET /:id

获取对应主键的书籍信息（不包含书本内容）

#### 参数

无

#### 返回

| 返回字段名 | 含义     |
| ---------- | -------- |
| data       | 数据信息 |

data 数据格式及含义：

| 字段名称  | 说明         |
| --------- | ------------ |
| ID        | 书籍ID       |
| Name      | 书籍名称     |
| Price     | 书籍价格     |
| Author    | 书籍作者     |
| Star      | 书籍评分     |
| PayNumber | 书籍购买人数 |
| Category  | 所属分类     |

### POST /

创建新书，需要管理员登录

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Name       | 书籍名称 |
| Price      | 书籍价格 |
| Author     | 作者     |
| Content    | 书籍内容 |
| Category   | 分类目录 |

以上表单项均为 required

#### 返回

`status` 和 `msg`

### PUT /:id

更新主键为 `id` 的书的信息，需要管理员权限

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Name       | 书籍名称 |
| Price      | 书籍价格 |
| Author     | 作者     |
| Content    | 书籍内容 |
| Category   | 分类目录 |

#### 返回

`status` 和 `msg`

### DELETE /:id

删除主键为 `id` 的书的信息，需要管理员权限

#### 返回

`status` 和 `msg`

## /Auth

### POST /

用户登录接口

#### 表单格式

| 表单项名称 | 说明   |
| ---------- | ------ |
| Username   | 用户名 |
| Password   | 密码   |

#### 返回

`status` 和 `msg`


### PUT /

更新用户信息

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Username   | 用户名   |
| Password   | 密码     |
| Name       | 昵称     |
| Email      | 邮件地址 |

以上全为 required

#### 返回

`status` 和 `msg`

## /newAuth

### POST /

用户注册接口

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Username   | 用户名   |
| Password   | 密码     |
| Name       | 昵称     |
| Email      | 邮件地址 |

以上全为 required

#### 返回

`status` 和 `msg`

## /categories

#### GET /

获得各个分类的信息以及各个分类的书本数量

#### 参数

无

#### 返回

| 字段名 | 说明               |
| ------ | ------------------ |
| id     | 分类id             |
| name   | 分类名称           |
| count  | 该分类下的书本数目 |

### DELETE /:id

删除某个分类，其中 id=1代表未分类书籍，不可删除id=1

#### 参数

无

#### 返回

`status` 和 `msg`

### PUT /:id

更新某个分类

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Name       | 分类名称 |

#### 返回

`status` 和 `msg

### POST /

创建新分类

#### 表单格式

| 表单项名称 | 说明     |
| ---------- | -------- |
| Name       | 分类名称 |

#### 返回

`status` 和 `msg

## /comments

### GET /

获取全部书评

#### 参数

| 参数名 | 解释                                      | 示例    |
| ------ | ----------------------------------------- | ------- |
| page   | 需要请求的页面，为空默认为第一页          | page=2  |
| book   | 需要请求的特定书籍 id，为空默认为全部评论 | book=15 |

#### 返回

| 返回字段名         | 含义                                                         |
| ------------------ | ------------------------------------------------------------ |
| data               | 数据信息                                                     |
| all comments count | 数据库当中所有条目的总数，方便制作分页。如果加入了 category 参数，则表示该分类下所有条目总数 |

`data` 格式：

| 字段名  | 含义             |
| ------- | ---------------- |
| ID      | 评论ID           |
| Content | 评论内容         |
| Star    | 评论对书籍的打分 |
| UserID  | 用户ID           |
| BookID  | 书籍ID           |

### GET /:id

获取对应 id 的书评

#### 参数

无

#### 返回

| 返回字段名 | 含义     |
| ---------- | -------- |
| data       | 数据信息 |

`data` 格式：

| 字段名  | 含义             |
| ------- | ---------------- |
| ID      | 评论ID           |
| Content | 评论内容         |
| Star    | 评论对书籍的打分 |
| UserID  | 用户ID           |
| BookID  | 书籍ID           |

### POST /

发表评论，需要登录

#### 表单格式

| 表单项名称 | 说明         |
| ---------- | ------------ |
| Content    | 评论内容     |
| Star       | 评分         |
| BookID     | 评论的书籍ID |

#### 返回

`status` 和 `msg`

### DELETE /:id

删除某一条评论，需要管理员或者用户自己删除

#### 参数

无

#### 返回

`status` 和 `msg`

## /carts

### GET /

获得该用户的所有购物车信息，需要登陆

#### 参数

无

#### 返回

`data` 格式：

| 字段名 | 含义     |
| ------ | -------- |
| ID     | 书籍ID   |
| name   | 书籍名称 |
| price  | 书籍价格 |
| author | 书籍作者 |

### DELETE /:id

删除该用户下书籍主键为 id 的购物车

#### 参数

无

#### 返回

`status` 和 `msg`

### POST /

当前用户下增加一条购物车条目

#### 表单格式

| 表单项名称 | 说明   |
| ---------- | ------ |
| BookID     | 书籍ID |

#### 返回

`status` 和 `msg`

## /purchased

### POST /

购买某一本书，需要登陆

#### 表单格式

无

#### 返回

`status` 和 `msg`

### GET /

查询所有购买的书籍的信息，需要登陆

#### 参数

无

#### 返回

`data` 格式：

| 字段名 | 含义     |
| ------ | -------- |
| ID     | 书籍ID   |
| name   | 书籍名称 |
| author | 书籍作者 |

#### GET /:id

阅读已经购买的一本书

#### 参数

无

#### 返回

`data` 格式：

| 字段名  | 含义     |
| ------- | -------- |
| ID      | 书籍ID   |
| name    | 书籍名称 |
| author  | 书籍作者 |
| content | 书籍内容 |